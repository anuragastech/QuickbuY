<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Yoga Studio Template">
    <meta name="keywords" content="Yoga, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Violet | Template</title>

    <!-- Google Font -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900&display=swap"
        rel="stylesheet">

    {{!-- modal CDN --}}
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <!-- Css Styles -->

    <link rel="stylesheet" href="/user/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/user/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/user/nice-select.css" type="text/css">
    <link rel="stylesheet" href="/user/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="/user/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="/user/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="/user/style.css" type="text/css">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Search model -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search model end -->

    <!-- Header Section Begin -->
    <header class="header-section">
        <div class="container-fluid">
            <div class="inner-header">
                <div class="logo">
                    <a href="/user/index"><img src="/logo.png" alt=""></a>
                </div>
                <div class="header-right">
                    <img src="/icons/search.png" alt="" class="search-trigger">
                    <img src="/icons/man.png" alt="">
                    <a href="#">
                        <img src="/icons/bag.png" alt="">
                        <span>2</span>
                    </a>
                </div>
                <div class="user-access">
                    <a href="/user/sign" style="display: none;">Register</a>
                    <a href="/user/login" style="display: none;" class="in">Sign in</a>
                    <a href="/user/sign">Logout</a>

                </div>
                <nav class="main-menu mobile-menu">
                    <ul>
                        <li><a class="active" href="/user/index">Home</a></li>
                        <li><a href="/user/categories">Shop</a>
                            <ul class="sub-menu">
                                <li><a href="/user/products">Product Page</a></li>
                                <li><a href="/user/shopping-cart">Shopping Card</a></li>
                                {{!-- <li><a href="/user/check-out">Check out</a></li> --}}
                            </ul>
                        </li>
                        <li><a href="/user/product-page">About</a></li>
                        <li><a href="/user/check-out">Blog</a></li>
                        <li><a href="/user/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <!-- Header Info Begin -->
    <div class="header-info">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-4">
                    <div class="header-item">
                        <img src="/icons/delivery.png" alt="">
                        <p>Free shipping on orders over $30 in USA</p>
                    </div>
                </div>
                <div class="col-md-4 text-left text-lg-center">
                    <div class="header-item">
                        <img src="/icons/voucher.png" alt="">
                        <p>20% Student Discount</p>
                    </div>
                </div>
                <div class="col-md-4 text-left text-xl-right">
                    <div class="header-item">
                        <img src="/icons/sales.png" alt="">
                        <p>30% off on dresses. Use code: 30OFF</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header Info End -->
    <!-- Header End -->

    <section class="page-add">
        <div class="container">
            <div class="row">
                <div class="col-lg-2">
                    <div class="page-breadcrumb">
                        <h2>Checkout<span>.</span></h2>
                    </div>
                </div>
                {{!-- <div class="col-lg-8">
                    <img src="/add.jpg" alt=""> --}}
                </div>
            </div>
        </div>
    </section>
    <div class="container">
        <div class="row">


            <div class="col-lg-3">
                <h5 class="font-size-16 mb-1">Add address</h5>
                <br>

                <button type="button" class="btn btn-light   btn-lg w-100 mb-3" style="border: 2px solid black;"
                    data-toggle="modal" data-target="#exampleModalCenter">
                    +
                </button>

            </div>
            <div class="col-lg-6">
                <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
                <style>
                    /* Custom CSS */
                    .address-box {
                        border: 1px solid #ccc;
                        border-radius: 5px;
                        padding: 10px;
                        margin-bottom: 10px;
                        cursor: pointer;
                        /* Add cursor pointer to indicate clickability */
                        position: relative;
                    }

                    .address-box.selected {
                        background-color: #f0f0f0;
                        /* Change background color when selected */
                    }

                    .select-indicator {
                        width: 12px;
                        height: 12px;
                        border-radius: 50%;
                        background-color: #2d29ec;
                        /* Bootstrap primary color for background */
                        position: absolute;
                        top: 5px;
                        right: 5px;
                        display: none;
                        /* Initially hide the select indicator */
                    }

                    .address-box.selected .select-indicator {
                        display: block;
                        /* Show select indicator when address is selected */
                    }

                    .xl {
                        color: black;
                        font-size: 12px;
                        font-weight: bolder;
                        font-family: sans-serif;
                    }
                </style>
                <h5 style="margin-left: 40px;">select Address</h4>
                    <div class="container">
                        <div class="card" style="border: none;">

                            <div class="card-body">
                                <div class="row">
                                    {{#each addressInfo}}
                                    <div class="col-lg-4">
                                        <div class="address-box" data-address-id="{{@index}}">
                                            <div class="address-details">
                                                <p class="xl"><strong>Address:</strong> {{this.address}}</p>
                                                <p class="xl"><strong>Phone:</strong> {{this.phone}}</p>
                                                <p class="xl"><strong>Country:</strong> {{this.country}}</p>
                                                <p class="xl"><strong>City:</strong> {{this.city}}</p>
                                                <p class="xl"><strong>State:</strong> {{this.state}}</p>
                                                <p class="xl"><strong>Pincode:</strong> {{this.pin}}</p>
                                            </div>
                                            <div class="select-indicator"></div> <!-- Select indicator -->
                                        </div>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                        </div>
                    </div>
                    {{!-- --------------------------------- --}}

<style>
    label{
        font-size: 15px;
    }
</style>

<style>
  /* Style for disabled button */
#applyCouponButton[disabled] {
    opacity: 0.5;
    cursor: not-allowed;
    /* You can add more styles to visually indicate it's disabled */
}
</style>
            </div>
    <div class="col-lg-3">
        <div style="height: 300px; overflow-y: auto;">
            {{#each data }}
            <div>
                <img style="height: 80px;width: 80px;" src="{{this.product.image.url}}" alt="">
                <label for="productname">Product Name: {{this.product.productname}}</label><br>
                <label for="productcolor">Color: {{this.product.color}}</label><br>
                <label for="price">Price: ₹{{this.product.price}}</label><br>
                <label for="size">Size: {{this.size}}</label><br>
            </div>
            {{/each}}
        </div>
        <hr>
        <label for="subtotal">Subtotal: <span id="subtotalValue">0</span></label><br>
        <label for="tax">Tax (5%): <span id="taxValue">0</span></label><br>
        <label for="shippingCost">Shipping Cost: <span id="shippingCostValue">0</span></label><br>
        <label for="grandTotal">Grand Total: <span id="grandTotalValue">0</span></label><br>
        <hr>
        <input type="text" id="couponCode" placeholder="Enter coupon code">
        <button id="applyCouponButton" onclick="applyCoupon()">Apply Coupon</button>
        <hr>
<div id="discountedAmountContainer">
    <label for="discountedAmount">Discounted totel Amount: <span id="discountedAmountValue">0</span></label>
</div>        <hr>
        <button style="height: 40px; width: 250px; background-color: rgb(0, 0, 0);color: white;">Payment</button>
        <hr>
    </div>



    <script>
        // Calculate and display grand total
        document.addEventListener("DOMContentLoaded", function() {
            const productElements = document.querySelectorAll('.col-lg-3 > div');
            let subtotal = 0;

            productElements.forEach(function(productElement) {
                const priceElement = productElement.querySelector('label[for="price"]');
                if (priceElement) {
                    const priceText = priceElement.textContent.trim(); // Get the price text
                    const priceMatch = priceText.match(/₹\s*([\d.]+)/); // Extract the price value (including decimals)
                    if (priceMatch && priceMatch[1]) {
                        const price = parseFloat(priceMatch[1]); // Extract the price value
                        subtotal += price;
                    } else {
                        console.error('Invalid price format:', priceText);
                    }
                } else {
                    console.error('Price element not found in product:', productElement);
                }
            });

            const tax = subtotal * 0.05; // Calculate tax (5%)
            const shippingCost = 15; // Flat shipping cost
            const grandTotal = subtotal + tax + shippingCost; // Calculate grand total

            const subtotalValueElement = document.getElementById('subtotalValue');
            subtotalValueElement.textContent = `₹${subtotal.toFixed(2)}`; // Format subtotal to 2 decimal places

            const taxValueElement = document.getElementById('taxValue');
            taxValueElement.textContent = `₹${tax.toFixed(2)}`; // Format tax to 2 decimal places

            const shippingCostValueElement = document.getElementById('shippingCostValue');
            shippingCostValueElement.textContent = `₹${shippingCost.toFixed(2)}`; // Format shipping cost to 2 decimal places

            const grandTotalValueElement = document.getElementById('grandTotalValue');
            grandTotalValueElement.textContent = `₹${grandTotal.toFixed(2)}`; // Format grand total to 2 decimal places

            // Store grand total in a hidden input field for passing to backend
            document.getElementById('grandTotalInput').value = grandTotal.toFixed(2);
        });
        
async function applyCoupon() {
    
    const couponCode = document.getElementById('couponCode').value;
    const grandTotalText = document.getElementById('grandTotalValue').textContent;
    const grandTotal = parseFloat(grandTotalText.replace('₹', '').trim());

    try {
        const response = await fetch(`/user/applycoupon`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ couponCode, grandTotal })
        });

        if (!response.ok) {
            throw new Error('Failed to apply coupon');
        }

        const data = await response.json();

        // Update the displayed grand total with the discounted amount
        document.getElementById('grandTotalValue').textContent = `₹${data.discountedAmount.toFixed(2)}`;

        // Display the discounted amount in the checkout page
        const discountedAmountContainer = document.getElementById('discountedAmountContainer');
        discountedAmountContainer.style.display = 'block';
        document.getElementById('discountedAmountValue').textContent = `₹${data.discountedAmount.toFixed(2)}`;
    } catch (error) {
        console.error('Error applying coupon:', error);
        // Handle error
    }
}
    </script>
{{!-- <script>

       async function applyCoupon() {
    const couponCode = document.getElementById('couponCode').value;
    const grandTotal=document,getElementById('grandTotalValue').value;
    try {
        // Send an AJAX request to the server to apply the coupon
        const response = await fetch(`/user/check-out?couponCode=${couponCode}&grandTotal=${grandTotal}`);

        const data = await response.text(); // Get the HTML content of the checkout page

        // Replace the current checkout page with the updated one
        document.body.innerHTML = data;
    } catch (error) {
        console.error('Error applying coupon:', error);
        // Handle errors
    }
}

</script> --}}





    <!-- Page Add Section Begin -->

    <!-- Page Add Section End -->

    <form class="frml" action="/user/checkout" method="POST">

        <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header bg-dark text-light">
                        <h5 class="modal-title" id="exampleModalLongTitle">Add
                            Category</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body bg-dark text-light">
                        <div>
                            <div class="row">
                                <div class="mb-3">
                                    <label class="form-label" for="billing-address">Address</label>
                                    <textarea class="form-control" name="address" id="billing-address" rows="3"
                                        placeholder="Enter full address"></textarea>
                                </div>

                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label" for="billing-phone">Phone</label>
                                        <input type="text" name="phone" class="form-control" id="billing-phone"
                                            placeholder="Enter Phone no.">
                                    </div>
                                </div>
                            </div>


                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-4 mb-lg-0">
                                        <label class="form-label">Country</label>
                                        <select class="form-control form-select" name="country" title="Country">
                                            <option value="0">Select Country
                                            </option>
                                            <option value="AF">Afghanistan</option>
                                            <option value="AL">Albania</option>
                                            <option value="DZ">Algeria</option>
                                            <option value="AS">American Samoa
                                            </option>
                                            <option value="AD">Andorra</option>
                                            <option value="AO">Angola</option>
                                            <option value="AI">Anguilla</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-4">
                                    <div class="mb-4 mb-lg-0">
                                        <label class="form-label" for="billing-city">City</label>
                                        <input type="text" name="city" class="form-control" id="billing-city"
                                            placeholder="Enter City">
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-4 mb-lg-0">
                                        <label class="form-label" for="billing-city">State</label>
                                        <input type="text" name="state" class="form-control" id="billing-statee"
                                            placeholder="Enter state">
                                    </div>
                                </div>

                                <div class="col-lg-4">
                                    <div class="mb-0">
                                        <label class="form-label" for="zip-code">Zip
                                            / Postal code</label>
                                        <input type="text" name="pin" class="form-control" id="zip-code"
                                            placeholder="Enter Postal code">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <!-- Add Submit Button -->
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </div>

        </div>
    </form>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Bootstrap JS (optional, if you need JavaScript functionalities from Bootstrap) -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // JavaScript for selecting one address at a time
        document.addEventListener('DOMContentLoaded', function () {
            const addressBoxes = document.querySelectorAll('.address-box');

            addressBoxes.forEach(box => {
                box.addEventListener('click', () => {
                    addressBoxes.forEach(box => {
                        box.classList.remove('selected');
                    });
                    box.classList.add('selected');
                });
            });
        });
    </script>

    <!-- submit  -->

    </div>
    </div>

    <!-- Bootstrap JS (optional, if needed) -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <!-- Check-out section  Page End -->




    {{!-- -------------------------------------------------------------------------- --}}
    <div id="checkout-data"></div>

    <script>
        // Fetch cart data and render it on the checkout page
        fetch('/api/postCarttocheckout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ selectedItems: yourSelectedItemsArray }) // Assuming yourSelectedItemsArray contains the selected item IDs
        })
            .then(response => response.json())
            .then(data => {
                // Render the fetched data on the page
                const checkoutDataElement = document.getElementById('checkout-data');
                checkoutDataElement.innerHTML = `
                <p>Matched Cart Items:</p>
                <ul>
                    ${data.matchcart.map(item => `<li>${item.name}: ${item.price}</li>`).join('')}
                </ul>
            `;
            })
            .catch(error => {
                console.error('Error fetching checkout data:', error);
            });
    </script>


    {{!-- ------------------------------------------------------------ --}}

    <!-- Footer Section Begin -->
    <footer class="footer-section spad">
        <div class="container">
            <div class="newslatter-form">
                <div class="row">
                    <div class="col-lg-12">
                        <form action="#">
                            <input type="text" placeholder="Your email address">
                            <button type="submit">Subscribe to our newsletter</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="footer-widget">
                <div class="row">
                    <div class="col-lg-3 col-sm-6">
                        <div class="single-footer-widget">
                            <h4>About us</h4>
                            <ul>
                                <li>About Us</li>
                                <li>Community</li>
                                <li>Jobs</li>
                                <li>Shipping</li>
                                <li>Contact Us</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="single-footer-widget">
                            <h4>Customer Care</h4>
                            <ul>
                                <li>Search</li>
                                <li>Privacy Policy</li>
                                <li>2019 Lookbook</li>
                                <li>Shipping & Delivery</li>
                                <li>Gallery</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="single-footer-widget">
                            <h4>Our Services</h4>
                            <ul>
                                <li>Free Shipping</li>
                                <li>Free Returnes</li>
                                <li>Our Franchising</li>
                                <li>Terms and conditions</li>
                                <li>Privacy Policy</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="single-footer-widget">
                            <h4>Information</h4>
                            <ul>
                                <li>Payment methods</li>
                                <li>Times and shipping costs</li>
                                <li>Product Returns</li>
                                <li>Shipping methods</li>
                                <li>Conformity of the products</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="social-links-warp">
            <div class="container">
                <div class="social-links">
                    <a href="" class="instagram"><i class="fa fa-instagram"></i><span>instagram</span></a>
                    <a href="" class="pinterest"><i class="fa fa-pinterest"></i><span>pinterest</span></a>
                    <a href="" class="facebook"><i class="fa fa-facebook"></i><span>facebook</span></a>
                    <a href="" class="twitter"><i class="fa fa-twitter"></i><span>twitter</span></a>
                    <a href="" class="youtube"><i class="fa fa-youtube"></i><span>youtube</span></a>
                    <a href="" class="tumblr"><i class="fa fa-tumblr-square"></i><span>tumblr</span></a>
                </div>
            </div>

            <div class="container text-center pt-5">



            </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="/user/jquery-3.3.1.min.js"></script>
    <script src="/user/bootstrap.min.js"></script>
    <script src="/user/jquery.magnific-popup.min.js"></script>
    <script src="/user/jquery.slicknav.js"></script>
    <script src="/user/owl.carousel.min.js"></script>
    <script src="/user/jquery.nice-select.min.js"></script>
    <script src="/user/mixitup.min.js"></script>
    <script src="/user/main.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>




</body>

</html>