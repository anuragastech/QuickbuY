<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Responsive Admin Dashboard</title>
    <!-- ======= Styles ====== -->
    <link rel="stylesheet" href="adminDashboard.css" />
    <lin
      rel="shortcut icon"
      type="image/png"
      href="./assets/imgs/favicon.ico"
    />
  </head>

  <body>
    <!-- =============== Navigation ================ -->
    <div class="container">
      <div class="navigation">
        <ul>
          <li>
            <a href="#">
              <span class="icon">
                <img src="./assets/imgs/favicon.ico" alt="" />
              </span>
              <span class="title">Dunprel Store</span>
            </a>
          </li>

          <li>
            <a href="/admin/main">
              <span class="icon">
                <ion-icon name="home-outline"></ion-icon>
              </span>
              <span class="title">Dashboard</span>
            </a>
          </li>

          <li>
            <a href="/admin/category">
              <span class="icon">
                <ion-icon name="people-outline"></ion-icon>
              </span>
              <span class="title">Category</span>
            </a>
          </li>

          <li>
            <a href="/admin/categorylist">
              <span class="icon">
                <ion-icon name="chatbubble-outline"></ion-icon>
              </span>
              <span class="title">CategoryList</span>
            </a>
          </li>

          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="help-outline"></ion-icon>
              </span>
              <span class="title">SubCategory</span>
            </a>
          </li>

          <li>
            <a href="/admin/">
              <span class="icon">
                <ion-icon name="settings-outline"></ion-icon>
              </span>
              <span class="title"></span>
            </a>
          </li>

          <li>
            <a href="/admin/">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title"></span>
            </a>
          </li>

          <li>
            <a href="/admin/logout">
              <span class="icon">
                <ion-icon name="log-out-outline"></ion-icon>
              </span>
              <span class="title">Sign Out</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
          <li>
            <a href="/admin/subcategories">
              <span class="icon">
                <ion-icon name="lock-closed-outline"></ion-icon>
              </span>
              <span class="title">Subcategorylist</span>
            </a>
          </li>
        </ul>
      </div>

      <!-- ========================= Main ==================== -->
      
    <style>
.xlm{
  height: 350px;
  width: 800px;
  margin-left: 750px;

  background-color: rgba(255, 255, 255, 0.372);
  border-radius: 30px;
  border: 10px solid rgb(237, 236, 236);

}
.full{
padding-top: 30px;
}
label{
 
 font-size: 30px;


}
.btn{
  height: 40px;
  width: 400px;
  background-color: black;

  border-radius: 30px;
  color: wheat;
  margin-left: 200px;
  margin-top: 70px;
  font-size: 18px;
  border: 2px solid white;

}
.btn:hover{
  border: solid black;

background-color: white;
color: black;
font-weight: bolder;
}
input{
  margin-top: 40px;
   font-size: 30px;
  height: 50px;
 margin-left: 20px;
  height: 50px;
  text-align: center;
    color: rgb(0, 0, 0);
    border-radius: 40px;
    font-size: larger;

}
.showsubcategory{
  margin-left: 600px;
  padding-top: 100px;
}

table{
width: 1100px;
text-align: center;
border: 10px solid black;
border-radius: 15px;
}
th{
  height: 40px;
  border: 2px solid black;
  

}
td{
  height: 120px;
  width: 200px;
   background-color: rgb(7, 7, 7);
   color: white;
  font-weight: bold;
}
.h{
  margin-left: 1000px;
  font-size: 30px;
  margin-bottom: 10px;

}
.pic{
  height: 150px;
  width:150px;
  overflow: hidden;
  border: 2px solid green;

      background-size: 0% ; /* Cover the entire container without black borders */
      background-position: center; /* Center the image within the container */
      background-repeat: no-repeat; /* Do not repeat the background */
    }

 .btn5{
    height: 50px;
    font-size: 18px;
    width:80px;
    background-color: rgb(245, 245, 245);
    color: rgb(5, 5, 5);
border-radius: 20px;
  }
  .btn5:hover{
    background-color: black;
    color: white;
  }

    </style>

<div class="full" style="background-color: rgba(249, 249, 249, 0.982);">
<h2 class="h">Add Subcategory</h2>

<form class="xlm" action="/admin/subcategories" method="POST" enctype="multipart/form-data">
  <label for="title">Title:</label>
  <input type="text" id="title" name="title" required>

  <label for="description">Description:</label>
  <textarea id="description" name="description" required></textarea>

  <label for="image">Image:</label>
  <input type="file" id="image" name="image" accept="image/*" required>
  <button type="submit">Upload</button>

    <label for="category">Category:</label>
  <select id="category" name="category" required>
    {{#each categories}}
      <option value="{{_id}}">{{title}}</option>
    {{/each}}
  </select>

  <!-- Assuming you have a dropdown to select the category -->
  {{!-- <label for="category">Category:</label>
  <select id="category" name="category" required> --}}
    <!-- Populate this dropdown with existing categories from your database -->
    <!-- For each category, create an <option> tag -->
    <!-- Example: <option value="{{categoryId}}">{{categoryTitle}}</option> -->


  </select>

  <button class="btn" type="submit">Add Subcategory</button>
</form>



<div class="showsubcategory">
<table>
    {{#if subcategories.length}}
      <thead>
        <tr>
          <th>Title</th>
          <th>Description</th>
          <th>Image</th>
          <th>Delete</th>
          <th>Edit</th>
        </tr>
      </thead>
      <tbody>
        {{#each subcategories}}
          <tr>
            <td>{{title}}</td>
            <td>{{description}}</td>
            <td   ><img  class="pic" src="{{image.url}}" alt="{{title}} Image" style="max-width: 100px;"></td>
            <td>
                    <button class="btn5" onclick="deleteSubCategory('{{this._id}}')">Delete</button>
                </td>
                <td>
                  
                   <button class="btn5"> <a href="/admin/edit-subcategory?name={{this._id}}">Edit</a> </button> 

                </td>
          </tr>
        {{/each}}
      </tbody>
    {{else}}
      <tr>
        <td colspan="3">No subcategories found.</td>
      </tr>
    {{/if}}
  </table>

</div>

</div>

{{!-- -------------------------------------------------------------- --}}

{{!-- {{#if categories.length}}
  <ul>
    {{#each categories}}
      <li>{{title}}</li>
      <!-- Add other category details as needed -->
    {{/each}}
  </ul>
{{else}}
  <p>No categories found.</p>
{{/if}} --}}

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', async () => {
    try {
      const response = await axios.get('/admin/categories');
      const categories = response.data.categories;

      if (categories.length) {
        const categorySelect = document.getElementById('category');

        categories.forEach(category => {
          const option = document.createElement('option');
          option.value = category._id;
          option.textContent = category.title;
          categorySelect.appendChild(option);
        });
      } else {
        console.error('No categories found.');
      }
    } catch (error) {
      console.error('Error fetching categories:', error.message);
    }
  });
</script>

{{!-- delete--}}
<script>
  function deleteSubCategory(subcategoryId) {
    axios.delete(`/admin/delete-subcategory/${subcategoryId}`)
      .then((response) => {
        if (response.status !== 200) {
          throw new Error('Delete request failed');
        } else {
          window.location.href = "/admin/subcategories";
        }
      })
      .catch((error) => {
        console.error(error);
      });
  }
</script>



</body>
</html>